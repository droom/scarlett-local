{% include '__has-variables' %}
<section id="cart-wrap" class="section-wrap">

  <form action="/cart" method="post" id="cartform1">

    {% include '__cart-breadcrumb' %}
    <div class="checkout_main">
      <div class="col-cart-left">

        <div class="checkout_stage1">

          {% include '__formatted-content' %}
          {% if has_cart %}
          {% if cart.item_count == 0 %}
          <h2>Your cart is empty!</h2>
          <p>Please add some items.</p>
          {% else %}
          {% include '__cart-table-buy' %}
          {% include '__cart-table-try' %}
          {% endif %}
          {% endif %}
        </div>

        <div class="checkout_stage2">
          <h2>Details</h2>
          <h3 class="clearfix">What kind of glasses do you need?</h3>


          <div class="radioOptions clearfix stage2question1">

            {% assign attribute = 'glasses-type' %}
            {% for i in (1..3) %}
            <div class="radioWrap clearfix">
              {% capture option %}{% cycle 'Prescription', 'Readers', 'Non-RX' %}{% endcapture %}
              <h4 class="radioTitle">{{ option }}</h4>
              <input class="radioNode" type="radio" id="{{ option }}-{{ i }}" name="attributes[{{ attribute }}]" value="{{ option }}"{% if cart.attributes[attribute] == option %} checked="checked"{% endif %} />
              <label class="radioLabel {{ option | handleize }}" for="{{ option | handleize }}-{{ i }}">{{ option }}</label>
            </div>
            {% endfor %}

          </div>


          <h3 class="clearfix">How would you like to send us your prescription?</h3>


          <div class="radioOptions clearfix stage2question2">

            {% assign attribute = 'prescription-method' %}
            {% for i in (1..3) %}
            <div class="radioWrap clearfix">
              {% capture option %}{% cycle 'Upload a picture', 'Call my doctor', 'Send letter' %}{% endcapture %}
              <h4 class="radioTitle">{{ option }}</h4>

              <input class="radioNode" type="radio" id="{{ option }}-{{ i }}" name="attributes[{{ attribute }}]" value="{{ option }}"{% if cart.attributes[attribute] == option %} checked="checked"{% endif %} />
              <label class="radioLabel {{ option | handleize }}" for="{{ option | handleize }}-{{ i }}">{{ option }}</label>
            </div>
            {% endfor %}

          </div>



          <div class="radioOptions clearfix">

            <div class="prescription-upload">

              <h6>Need custom copy to introduce/explain this segment</h6>
              <input type="file" name="attributes[prescription]" value="{{ cart.attributes.prescription }}" />
            </div>

            <div class="prescription-doctor">
              <h6>Need custom copy to introduce/explain this segment</h6>
              <label for="doctorContact">Doctor's number</label>
              <input type="text" id="doctorContact" name="attributes[doctor]" value="{{ cart.attributes.doctor }}" />
            </div>

            <div class="prescription-address">
              <h6>Need custom copy to introduce/explain this segment</h6>
              <p>
                Scarlett of Soho, <br /> 
                2 Kelly Court, <br />
                2 Garford Street, <br />
                E14 8JQ<br />
                United Kingdom
              </p>
            </div>
          </div>


          <h3 class="clearfix">Do you want ultra high-index lenses if necessary?</h3>

          <div class="radioOptions clearfix stage2question3">
            {% assign attribute = 'high-index' %}
            {% for i in (1..2) %}
            <div class="radioWrap clearfix">
              {% capture option %}{% cycle 'Yes', 'No' %}{% endcapture %}
              <h4 class="radioTitle">{{ option }}</h4>

              <input class="radioNode" type="radio" id="{{ option }}-{{ i }}" name="attributes[{{ attribute }}]" value="{{ option }}"{% if cart.attributes[attribute] == option %} checked="checked"{% endif %} />
              <label class="radioLabel {{ option | handleize }}" for="{{ option | handleize }}-{{ i }}">{{ option }}</label>
            </div>
            {% endfor %}
          </div>

          <h3 class="clearfix">Do you want to measure your pupil distance?</h3>

          <div class="radioOptions clearfix stage2question4">
            {% assign attribute = 'pd-tool' %}
            {% for i in (1..2) %}
            <div class="radioWrap clearfix">
              {% capture option %}{% cycle 'measure', 'dont-measure' %}{% endcapture %}
              <h4 class="radioTitle {{ option }}">{{ option }}</h4>
              <input class="radioNode" type="radio" id="{{ option }}-{{ i }}" name="attributes[{{ attribute }}]" value="{{ option }}"{% if cart.attributes[attribute] == option %} checked="checked"{% endif %} />
              <label class="radioLabel {{ option | handleize }}" for="{{ option | handleize }}-{{ i }}">{{ option }}</label>
            </div>
            {% endfor %}
          </div>



          <div class="radioOptions clearfix">

            <div class="pd-launch">

              <h6>Need custom copy to introduce/explain this segment/give directions</h6>

              <p><a href="http://evening-oasis-1684.herokuapp.com/" class="launch">Launch tool</a></p>
              <p>Please plug in your data!</p>
              <input type="text" name="attributes[pd]" value="{{ cart.attributes.pd }}" />
            </div>

          </div>

        </div>

        <div class="checkout_stage3">
          <p>
            Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
          </p>
        </div>


      </div>

      <div class="col-cart-right">
        {% include '__cart-price' %}

        <section class="cart-customer">
          {% include '__cart-customer' %}
        </section>

        <section class="cart-list">
          {% include '__cart-item-list' %}
        </section>

      </div>

    </div>


  </form>

  <!-- </div> -->

</section>  


<script>
  $(document).ready(function(){

    var activeColor = '#a54c3a' ;
    var inactiveColor = '#333' ;
    var checkout_section_position = 0;
    var checkout_try_required = 5;
    var checkout_try_array = $('.checkout_try').length;
    var checkout_try_remaining = parseInt(checkout_try_required - checkout_try_array);




    // on load

    // on load checkout button
    $('#checkout').css('display', 'none');

    // on load hide segment 2, 3
    $('.checkout_stage1').css('display', 'block');
    $('.checkout_stage2').css('display', 'none');
    $('.checkout_stage3').css('display', 'none');
    
    // on load hide segment 2, 3
    $('.checkout_breadcrumb .step1 a').css('color', activeColor);


    // hide secondary fields
    $('.prescription-upload').css('display', 'none');
    $('.prescription-doctor').css('display', 'none');
    $('.prescription-address').css('display', 'none');

    $('.pd-launch').css('display', 'none');

    $('.cart-list').css('display', 'none');

    $("h4.measure").text("Yes");

    $("h4.dont-measure").text("No");

    $("label[for='prescription-1']").text("I need prescription lenses for my glasses.");

    $("label[for='readers-2']").text("I need reading / magnifying lenses for my glasses.");

    $("label[for='non-rx-3']").text("I need non-prescription lenses for my glasses.");

    $("label[for='upload-a-picture-1']").text("I will attach a copy of my prescription and upload it from my computer.");

    $("label[for='call-my-doctor-2']").text("I would like you to call my doctor and obtin my prescription.");

    $("label[for='send-letter-3']").text("I don't have my prescription right now but I will send it to Scarlett of Soho later.");

    $("label[for='yes-1']").text("Please use high index lenses for an additional Â£30 if I have a strong prescription.");

    $("label[for='no-2']").text("I would like you to call my doctor and obtain my prescription");

    $("label[for='measure-1']").text("Yes please, I'd like to measure my pupil distance");
    
    $("label[for='dont-measure-2']").text("No, thank you");


    // $('.checkout_breadcrumb .step1').click(function(){
    //   checkout_section(".step1");
    //   checkout_section_position = 1;
    // });    
    // $('.checkout_breadcrumb .step2').click(function(){
    //   checkout_section(".step2");
    //   checkout_section_position = 2;
    // });    
    // $('.checkout_breadcrumb .step3').click(function(){
    //   checkout_section(".step3");
    //   checkout_section_position = 3;
    

    function checkout_section(stepValue){

      console.log("hey you clicked on "+stepValue);
      console.log("checkout_section_position "+checkout_section_position);

      $('.checkout_breadcrumb .step1 a').css('color', inactiveColor);
      $('.checkout_breadcrumb .step2 a').css('color', inactiveColor);
      $('.checkout_breadcrumb .step3 a').css('color', inactiveColor);
      $('.checkout_breadcrumb '+stepValue+' a').css('color', activeColor);
      $('.checkout_stage1').css('display', 'none');
      $('.checkout_stage2').css('display', 'none');
      $('.checkout_stage3').css('display', 'none');
      $('.checkout_stage'+checkout_section_position).css('display', 'block');

    };


    function gotoNextSection(position){
      console.log(position);

      if ( position == 0 ){

        $('#continue').css('display', 'block');
        $('#checkout').css('display', 'none');

        $('.checkout_stage1').css('display', 'block');
        $('.checkout_stage2').css('display', 'none');
        $('.checkout_stage3').css('display', 'none');

        $('.checkout_breadcrumb .step1 a').css('color', activeColor);
        $('.checkout_breadcrumb .step2 a').css('color', inactiveColor);

        $('.cart-customer').css('display', 'block');
        $('.cart-list').css('display', 'none');
      }


      if ( position == 1 ){

        $('#continue').css('display', 'none');
        $('#checkout').css('display', 'block');

        $('.checkout_stage1').css('display', 'none');
        $('.checkout_stage2').css('display', 'block');
        $('.checkout_stage3').css('display', 'none');

        $('.checkout_breadcrumb .step1 a').css('color', inactiveColor);
        $('.checkout_breadcrumb .step2 a').css('color', activeColor);

        $('.cart-customer').css('display', 'none');
        $('.cart-list').css('display', 'block');
      }
    };    



    $('.btnContinue').click(function(){
      checkout_section_position++;
      gotoNextSection(checkout_section_position);
    });   

    $('.checkout_breadcrumb .step1 a').click(function(){
      checkout_section_position = 0;
      gotoNextSection(checkout_section_position);
    });   

    $('.checkout_breadcrumb .step2 a').click(function(){
      checkout_section_position = 1;
      gotoNextSection(checkout_section_position);
    });   


    $('.upload-a-picture').click(function() {
      $('.prescription-upload').css('display', 'block');
      $('.prescription-doctor').css('display', 'none');
      $('.prescription-address').css('display', 'none');
    });

    $('.call-my-doctor').click(function() {
      $('.prescription-upload').css('display', 'none');
      $('.prescription-doctor').css('display', 'block');
      $('.prescription-address').css('display', 'none');
    });

    $('.send-letter').click(function() {
      $('.prescription-upload').css('display', 'none');
      $('.prescription-doctor').css('display', 'none');
      $('.prescription-address').css('display', 'block');
    });




    $('.radioWrap .radioLabel').hover(function() {
      $('selector').css( 'cursor', 'pointer' );
    });


    $('.stage2question1 .radioWrap .radioLabel').click(function() {
      $('.stage2question1 .radioWrap .radioLabel').css('font-weight', 'normal');
      $(this).css('font-weight', 'bold');
    });


    $('.stage2question2 .radioWrap .radioLabel').click(function() {
      $('.stage2question2 .radioWrap .radioLabel').css('font-weight', 'normal');
      $(this).css('font-weight', 'bold');
    }); 


    $('.stage2question3 .radioWrap .radioLabel').click(function() {
      $('.stage2question3 .radioWrap .radioLabel').css('font-weight', 'normal');
      $(this).css('font-weight', 'bold');
    }); 

    $('.stage2question4 .radioWrap .radioLabel').click(function() {
      $('.stage2question4 .radioWrap .radioLabel').css('font-weight', 'normal');
      $(this).css('font-weight', 'bold');
    }); 


    $('.measure').click(function() {
      $('.pd-launch').css('display', 'block');
    });

    $('.dont-measure').click(function() {
      $('.pd-launch').css('display', 'none');
    });


    $('.launch').click(function(event) {
      event.preventDefault();
      window.open($(this).attr("href"), "popupWindow", "width=600,height=600,scrollbars=yes");
    });

    function remove_item(id) {
      document.getElementById('updates_'+id).value = 0;
      document.getElementById('cart').submit();
    }

    for ( var i = 0; i < checkout_try_remaining; i++ ) {
      var numberStamp = i + 1 + checkout_try_array;
      console.log( "generate cell " + i );
      $( "<div class=\"checkout_try empty\"><h5 id=\'test\'><strong>"+numberStamp+"</stroxng>. Please add another frame</h5></div>").appendTo( ".generate_empty_cells");
    }


  });
</script>
